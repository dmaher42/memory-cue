import{a as be,b as xt}from"./chunk-LAXPI5MM.js";import{a as qe,b as Dt}from"./chunk-MG4MJA24.js";import{b as _e,c as Lt}from"./chunk-GUVSRPRW.js";function Ue(t,e=document){return!Array.isArray(t)||!e||typeof e.getElementById!="function"?[]:t.map(({key:n,ids:i})=>{if(!Array.isArray(i))return null;for(let o of i){if(typeof o!="string"||!o)continue;let s=e.getElementById(o);if(s)return{key:n,element:s}}return null}).filter(n=>!!(n&&n.element))}function O(t,e){if(!t||typeof t!="object")return"";let n=At[e]||[e];for(let i of n)if(Object.prototype.hasOwnProperty.call(t,i)){let o=t[i];return o==null?"":typeof o=="string"?o:String(o)}return""}function It(t,e){if(!t)return;let n=e??"";if(t instanceof HTMLInputElement){t.type==="checkbox"?t.checked=!!n:t.value=typeof n=="string"?n:String(n);return}(t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement)&&(t.value=typeof n=="string"?n:String(n))}function Bt(t){return t?t instanceof HTMLInputElement?t.type==="checkbox"?t.checked:t.value:t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement?t.value:"":""}function Ve(t,e){Array.isArray(e)&&e.forEach(({key:n,element:i})=>{let o=t&&typeof t=="object"?O(t,n):"";It(i,o)})}function $e(t,e,n,i){Array.isArray(t)&&t.forEach(({element:o})=>{o instanceof HTMLInputElement?["checkbox","radio"].includes(o.type)?o.checked=!1:o.value="":(o instanceof HTMLTextAreaElement||o instanceof HTMLSelectElement)&&(o.value="")}),e&&(e.value=""),n&&(n.textContent=i)}function je(t){let e={};return Array.isArray(t)&&t.forEach(({key:n,element:i})=>{let o=Bt(i);if(typeof o=="boolean"){e[n]=o;return}let s=typeof o=="string"?o.trim():o;e[n]=s??""}),e}function S(t){return t==null?"":String(t).replace(/[&<>'"]/g,e=>{switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#39;";default:return e}})}var Pe,At,Ee,ve,Ke=_e(()=>{Pe=[{key:"title",ids:["cue-title","title"]},{key:"details",ids:["cue-details","details","cue-description"]},{key:"date",ids:["cue-date","date"]},{key:"time",ids:["cue-time","time"]},{key:"priority",ids:["cue-priority","priority"]},{key:"category",ids:["cue-category","category"]}],At={title:["title","name"],details:["details","description","notes","body"],date:["date","dueDate","due_date"],time:["time","dueTime","due_time"],priority:["priority","level"],category:["category","tag"]},Ee="Create Cue",ve="Edit Cue"});function ze(t){return new Te(t)}var Ft,Nt,Te,Ye=_e(()=>{Ft=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),Nt={prepare:"cue:prepare",openRequest:"cue:open",closeRequest:"cue:close",cancelled:"cue:cancelled",shown:"cue:shown",hidden:"cue:hidden"},Te=class t{static activeStack=[];constructor(e={}){this.modal=e.modalElement??null,this.openButton=e.openButton??null,this.closeButton=e.closeButton??null,this.backdropButton=e.backdropButton??null,this.titleInput=e.titleInput??null,this.modalTitle=e.modalTitle??null,this.defaultTitle=e.defaultTitle??"",this.editTitle=e.editTitle??e.defaultTitle??"",this.isOpen=!1,this.isDestroyed=!1,this.manageAria=e.manageAria!==!1,this.enableFocusTrap=e.focusTrap!==!1,this.shouldAutoFocus=e.autoFocus!==!1,this.eventTarget=e.eventTarget??document,this.events={...Nt,...e.events||{}},this.animationHooks=e.animationHooks??{},this.enableStacking=e.enableStacking!==!1,this.isDisabled=!1,this.previouslyFocusedElement=null,this.boundHandlers={handleOpenClick:this.handleOpenClick.bind(this),handleCloseClick:this.handleCloseClick.bind(this),handleBackdropClick:this.handleBackdropClick.bind(this),handleCancel:this.handleCancel.bind(this),handleKeydown:this.handleKeydown.bind(this),handleDocumentOpenRequest:this.handleDocumentOpenRequest.bind(this),handleDocumentCloseRequest:this.handleDocumentCloseRequest.bind(this)},this.init()}init(){if(!this.validateModal()){this.isDisabled=!0;return}this.manageAria&&this.applyAriaAttributes(),this.setupEventListeners()}validateModal(){return!this.modal||!(this.modal instanceof HTMLElement)?(console.warn("[ModalController] Modal element is not provided or invalid."),!1):(typeof this.modal.showModal!="function"&&(this.modal.showModal=this.modal.showModal||(()=>{this.modal?.setAttribute("open","")})),typeof this.modal.close!="function"&&(this.modal.close=this.modal.close||(()=>{this.modal?.removeAttribute("open")})),this.modal.hasAttribute("tabindex")||(this.modal.tabIndex=-1),!0)}applyAriaAttributes(){this.modal&&(this.modal.setAttribute("role",this.modal.getAttribute("role")||"dialog"),this.modal.setAttribute("aria-modal","true"),this.modalTitle&&this.modalTitle.id&&this.modal.setAttribute("aria-labelledby",this.modalTitle.id),this.titleInput&&this.titleInput.id&&this.modal.setAttribute("aria-describedby",this.titleInput.id),this.modal.setAttribute("aria-hidden","true"))}async show(e={}){if(!(!this.modal||this.isDestroyed||this.isDisabled)){if(this.isOpen){this.shouldAutoFocus&&this.focusTitleInput();return}await this.runHook("onBeforeShow"),this.previouslyFocusedElement=document.activeElement instanceof HTMLElement?document.activeElement:null,this.enableStacking&&this.addToStack(),typeof this.modal.showModal=="function"&&!this.modal.open?this.modal.showModal():this.modal.setAttribute("open",""),this.modal.setAttribute("aria-hidden","false"),this.isOpen=!0,this.shouldAutoFocus&&this.focusTitleInput(),this.dispatchEvent("shown",{controller:this,...e}),await this.runHook("onAfterShow")}}async hide(e={}){!this.modal||this.isDestroyed||this.isDisabled||!this.isOpen||(await this.runHook("onBeforeHide"),typeof this.modal.close=="function"&&this.modal.open?this.modal.close():this.modal.removeAttribute("open"),this.modal.setAttribute("aria-hidden","true"),this.isOpen=!1,this.removeFromStack(),await this.restoreFocus(),this.dispatchEvent("hidden",{controller:this,...e}),await this.runHook("onAfterHide"))}focusTitleInput(){let e=this.titleInput||this.modal?.querySelector("[autofocus]");!e||typeof e.focus!="function"||window.setTimeout(()=>{try{e.focus({preventScroll:!0})}catch{e.focus()}},50)}async restoreFocus(){let e=this.previouslyFocusedElement||this.openButton;if(e&&typeof e.focus=="function")try{e.focus({preventScroll:!0})}catch{e.focus()}this.previouslyFocusedElement=null}setupEventListeners(){this.modal&&(this.openButton&&this.openButton.addEventListener("click",this.boundHandlers.handleOpenClick),this.closeButton&&this.closeButton.addEventListener("click",this.boundHandlers.handleCloseClick),this.backdropButton&&this.backdropButton.addEventListener("click",this.boundHandlers.handleBackdropClick),this.modal.addEventListener("cancel",this.boundHandlers.handleCancel),this.modal.addEventListener("keydown",this.boundHandlers.handleKeydown),this.eventTarget&&(this.eventTarget.addEventListener(this.events.openRequest,this.boundHandlers.handleDocumentOpenRequest),this.eventTarget.addEventListener(this.events.closeRequest,this.boundHandlers.handleDocumentCloseRequest)))}cleanup(){this.modal&&(this.openButton&&this.openButton.removeEventListener("click",this.boundHandlers.handleOpenClick),this.closeButton&&this.closeButton.removeEventListener("click",this.boundHandlers.handleCloseClick),this.backdropButton&&this.backdropButton.removeEventListener("click",this.boundHandlers.handleBackdropClick),this.modal.removeEventListener("cancel",this.boundHandlers.handleCancel),this.modal.removeEventListener("keydown",this.boundHandlers.handleKeydown),this.eventTarget&&(this.eventTarget.removeEventListener(this.events.openRequest,this.boundHandlers.handleDocumentOpenRequest),this.eventTarget.removeEventListener(this.events.closeRequest,this.boundHandlers.handleDocumentCloseRequest)))}async destroy(e={}){this.isDestroyed||(await this.hide(e),this.cleanup(),this.isDestroyed=!0)}setEditMode(e=!1){this.modalTitle&&(this.modalTitle.textContent=e?this.editTitle:this.defaultTitle),this.modal&&this.modal.setAttribute("data-mode",e?"edit":"create"),this.currentMode=e?"edit":"create"}handleOpenClick(e){e.preventDefault(),this.dispatchEvent("prepare",{mode:"create",controller:this}),this.setEditMode(!1),this.show({reason:"open-button"})}handleCloseClick(e){e.preventDefault(),this.requestClose("user-dismissed")}handleBackdropClick(e){e.preventDefault(),this.requestClose("backdrop")}handleCancel(e){e.preventDefault(),this.requestClose("keyboard")}handleKeydown(e){this.enableFocusTrap&&e.key==="Tab"&&this.maintainFocus(e),e.key==="Escape"&&this.requestClose("keyboard")}maintainFocus(e){if(!this.modal)return;let n=this.getFocusableElements();if(n.length===0){e.preventDefault(),this.modal.focus();return}let i=n[0],o=n[n.length-1],s=document.activeElement;e.shiftKey&&s===i?(e.preventDefault(),o.focus()):!e.shiftKey&&s===o&&(e.preventDefault(),i.focus())}getFocusableElements(){return this.modal?Array.from(this.modal.querySelectorAll(Ft)).filter(e=>!(e instanceof HTMLElement)||e.hasAttribute("disabled")?!1:e.getAttribute("aria-hidden")!=="true"):[]}handleDocumentOpenRequest(e){if(!e||e.detail&&e.detail.controller&&e.detail.controller!==this)return;let n=e?.detail?.mode==="edit";this.setEditMode(n),this.show({reason:e?.detail?.reason||"external-open",mode:e?.detail?.mode})}handleDocumentCloseRequest(e){if(!e||e.detail?.controller&&e.detail.controller!==this||e.detail?.initiatedBy==="controller")return;let n=e.detail?.reason||"external-close";this.hide({reason:n})}dispatchEvent(e,n={}){let i=this.events[e];if(!i||!this.eventTarget||typeof this.eventTarget.dispatchEvent!="function")return;let o=new CustomEvent(i,{detail:n,bubbles:!1,cancelable:!0});this.eventTarget.dispatchEvent(o)}requestClose(e){let n={reason:e,controller:this};this.dispatchEvent("cancelled",n),this.dispatchEvent("closeRequest",{...n,initiatedBy:"controller"}),this.hide({reason:e})}async runHook(e){let n=this.animationHooks?.[e];typeof n=="function"&&await n(this)}addToStack(){let e=t.activeStack,n=e.indexOf(this);n!==-1&&e.splice(n,1),e.push(this),this.stackIndex=e.length-1,this.modal?.setAttribute("data-stack-index",String(this.stackIndex))}removeFromStack(){let e=t.activeStack,n=e.indexOf(this);n!==-1&&e.splice(n,1),this.stackIndex=void 0,this.modal&&this.modal.removeAttribute("data-stack-index")}}});var mn=Lt(()=>{Dt();xt();Ke();Ye();qe();function Mt(){if(typeof document>"u")return;let t=document.getElementById("add-reminder-modal")??document.getElementById("reminder-modal"),e=document.getElementById("add-reminder-form")??document.getElementById("reminder-form"),n=document.getElementById("reminder-title");if(!t||!e||!n)return;let i=document.querySelectorAll("[data-open-reminder-modal]");if(!i.length)return;let o=t.querySelector("[data-reminder-modal-backdrop]"),s=t.querySelectorAll("[data-close-modal]"),a=document.getElementById("mainContent"),l=document.querySelector('nav[aria-label="Primary"]'),u=[a,l],m=null,y=c=>{u.forEach(d=>{d&&(c?d.setAttribute("inert",""):d.removeAttribute("inert"))})},f=()=>{t.classList.add("hidden"),t.setAttribute("aria-hidden","true"),t.setAttribute("inert",""),y(!1),document.removeEventListener("keydown",b,!0),m&&typeof m.focus=="function"&&m.focus()},b=c=>{c.key==="Escape"&&(c.preventDefault(),f())},ue=()=>{m=document.activeElement,t.classList.remove("hidden"),t.removeAttribute("aria-hidden"),t.removeAttribute("inert"),y(!0),document.addEventListener("keydown",b,!0),window.requestAnimationFrame(()=>{n.focus()})};i.forEach(c=>{c.addEventListener("click",d=>{d.preventDefault(),ue()})}),s.forEach(c=>{c.addEventListener("click",d=>{d.preventDefault(),f()})}),t.addEventListener("click",c=>{c.target===t&&f()}),o?.addEventListener("click",c=>{c.target===o&&f()});let P=document.getElementById("reminders-list"),me=document.getElementById("reminder-date"),U=document.getElementById("reminder-priority"),fe=document.getElementById("reminder-notes"),M=c=>{if(!c)return"";let d=new Date(c);return Number.isNaN(d.getTime())?"":d.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})},he=({title:c,dueDate:d,priority:E,notes:D})=>{if(typeof document>"u")return null;let x=document.createElement("li");x.className="reminder-item";let V=document.createElement("div");V.className="reminder-main space-y-2";let pe=document.createElement("p");pe.className="font-semibold text-base-content",pe.textContent=c,V.appendChild(pe);let G=[],Oe=M(d);Oe&&G.push(`Due ${Oe}`);let wt=E?E.trim().toLowerCase():"",Q={high:{badgeClass:"badge badge-outline text-error",badgeLabel:"High priority",detailLabel:"High priority"},medium:{badgeClass:"badge badge-outline text-warning",badgeLabel:"Due soon",detailLabel:"Medium priority"},low:{badgeClass:"badge badge-outline text-secondary",badgeLabel:"Scheduled",detailLabel:"Low priority"}}[wt]??{badgeClass:"badge badge-outline text-secondary",badgeLabel:"Scheduled",detailLabel:E||""};if(Q.detailLabel&&G.push(Q.detailLabel),G.length){let A=document.createElement("p");A.className="text-sm text-base-content/70",A.textContent=G.join(" \xB7 "),V.appendChild(A)}if(D){let A=document.createElement("p");A.className="text-sm text-base-content/60",A.textContent=D,V.appendChild(A)}x.appendChild(V);let W=document.createElement("div");W.className="reminder-meta flex flex-col items-end gap-2 sm:flex-row sm:items-center sm:gap-3";let ye=document.createElement("span");ye.className=Q.badgeClass,ye.textContent=Q.badgeLabel,W.appendChild(ye);let ge=document.createElement("div");ge.className="reminder-actions flex flex-wrap items-center justify-end gap-2";let H=document.createElement("button");H.className="btn btn-sm btn-success",H.type="button",H.textContent="Complete",H.disabled=!0,H.title="Coming soon";let R=document.createElement("button");return R.className="btn btn-sm btn-outline",R.type="button",R.textContent="Snooze",R.disabled=!0,R.title="Coming soon",ge.append(H,R),W.appendChild(ge),x.appendChild(W),x};e.addEventListener("submit",c=>{c.preventDefault();let d=n.value.trim();if(!d){n.focus();return}let E=fe?.value??"",D={title:d,dueDate:me?.value||"",priority:U?.value||"",notes:E.trim()},x=P?he(D):null;x&&P&&P.prepend(x),e.reset(),f()})}Mt();var Ge=document.getElementById("settings-save-button"),J=document.getElementById("settings-save-confirmation"),Qe=document.getElementById("live-status"),Ce=null;Ge&&J&&Ge.addEventListener("click",t=>{t.preventDefault(),J.classList.remove("hidden"),J.textContent="Settings saved!",Qe&&(Qe.textContent="Settings saved!"),Ce&&window.clearTimeout(Ce),Ce=window.setTimeout(()=>{J.classList.add("hidden")},3e3)});var rt=document.getElementById("title"),Ht=document.getElementById("reminderText"),k=(()=>{let t=document.getElementById("cue-modal")??document.getElementById("cue_modal");return ze({modalElement:t,openButton:document.getElementById("openCueModal"),closeButton:document.getElementById("closeCueModal"),backdropButton:t?.querySelector(".modal-backdrop button")??null,titleInput:rt,modalTitle:document.getElementById("modal-title"),defaultTitle:Ee,editTitle:ve})})();k?.setEditMode(!1);var Rt=()=>{let t=!!rt,e=!!Ht;return!t&&!e?Promise.resolve():e?be({variant:"mobile",titleSel:"#reminderText",dateSel:"#reminderDate",timeSel:"#reminderTime",detailsSel:"#reminderDetails",prioritySel:"#priority",categorySel:"#category",saveBtnSel:"#saveReminder",cancelEditBtnSel:"#cancelEditBtn",listSel:"#reminderList",listWrapperSel:"#remindersWrapper",emptyStateSel:"#emptyState",statusSel:"#statusMessage",syncStatusSel:"#syncStatus",voiceBtnSel:"#voiceBtn",notifBtnSel:"#notifBtn",categoryOptionsSel:"#categorySuggestions",countTotalSel:"#totalCount",googleSignInBtnSel:"#googleSignInBtn",googleSignOutBtnSel:"#googleSignOutBtn",googleAvatarSel:"#googleAvatar",googleUserNameSel:"#googleUserName",syncAllBtnSel:"#syncAll",syncUrlInputSel:"#syncUrl",saveSettingsSel:"#saveSyncSettings",testSyncSel:"#testSync",openSettingsSel:'[data-open="settings"]',dateFeedbackSel:"#dateFeedback"}):be({titleSel:"#title",dateSel:"#date",timeSel:"#time",detailsSel:"#details",prioritySel:"#priority",categorySel:"#category",saveBtnSel:"#saveBtn",cancelEditBtnSel:"#cancelEditBtn",listSel:"#reminderList",statusSel:"#auth-feedback",syncStatusSel:"#syncStatus",voiceBtnSel:"#voiceBtn",categoryOptionsSel:"#categorySuggestions",countTotalSel:"#inlineTotalCount",emptyStateSel:"#emptyState",listWrapperSel:"#remindersWrapper",dateFeedbackSel:"#dateFeedback",googleSignInBtnSel:"#googleSignInBtn",googleSignOutBtnSel:"#googleSignOutBtn",googleUserNameSel:"#googleUserName",variant:"desktop"})};Rt().catch(t=>{console.error("Failed to initialise reminders",t)});var w=document.getElementById("cues-list"),$=document.getElementById("pinnedNotesList"),N=document.getElementById("cue-form"),C=N?.querySelector("#cue-id-input"),Ot=k?.defaultTitle||k?.modalTitle?.textContent?.trim()||Ee,vn=k?.editTitle||ve,ae=document.getElementById("tab-cues"),re=document.getElementById("tab-daily"),j=document.getElementById("cues-view"),K=document.getElementById("daily-list-view"),We=document.getElementById("daily-list-header"),lt=document.getElementById("quick-add-form"),g=document.getElementById("quick-add-input"),v=document.getElementById("daily-voice-btn"),I=document.getElementById("daily-tasks-container"),Se=document.getElementById("clear-completed-btn"),le=document.getElementById("daily-list-permission-notice"),Je=document.getElementById("remindersCount"),Xe=document.getElementById("plannerCount"),Tn=document.getElementById("resourcesCount"),Cn=document.getElementById("templatesCount"),X=document.getElementById("dailySnapshotList"),Z=document.getElementById("todaysFocusList"),z={high:{badgeClass:"badge badge-outline text-error",badgeLabel:"High priority",rank:0},medium:{badgeClass:"badge badge-outline text-warning",badgeLabel:"Due soon",rank:1},low:{badgeClass:"badge badge-outline text-secondary",badgeLabel:"Scheduled",rank:2}},Ze=(()=>{try{return new Intl.DateTimeFormat(void 0,{hour:"2-digit",minute:"2-digit"})}catch{return null}})(),et=(()=>{try{return new Intl.DateTimeFormat(void 0,{month:"short",day:"numeric"})}catch{return null}})(),ie=t=>t?(typeof t.title=="string"?t.title.trim():"")||"Untitled reminder":"",xe=t=>{if(!t?.due)return null;try{let e=new Date(t.due);return Number.isNaN(e.getTime())?null:e}catch{return null}},_t=(t,e)=>!t||!e?!1:t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate(),ct=t=>{if(!t)return"";if(Ze)try{return Ze.format(t)}catch{}let e=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");return`${e}:${n}`},qt=t=>{if(!t)return"";if(et)try{return et.format(t)}catch{}return t.toLocaleDateString()},dt=t=>{let e=typeof t?.priority=="string"?t.priority.trim().toLowerCase():"";return Object.prototype.hasOwnProperty.call(z,e)?e:"medium"},tt=t=>{let e=dt(t);return z[e]?.rank??z.medium.rank},Pt=t=>{let e=dt(t);return z[e]??z.medium},nt=t=>{let e=xe(t);return e?e.getTime():Number.POSITIVE_INFINITY};function ut(t=[]){if(!X)return;let e=new Date,n=(Array.isArray(t)?t:[]).map(i=>({reminder:i,date:xe(i)})).filter(({date:i})=>i&&_t(i,e)).sort((i,o)=>i.date.getTime()-o.date.getTime());if(!n.length){X.innerHTML='<p class="text-sm text-base-content/60">No reminders due today.</p>';return}X.innerHTML="",n.forEach(({reminder:i,date:o})=>{let s=document.createElement("li");s.className="rounded-xl border border-base-200 bg-base-100/80 p-3 shadow-sm";let a=document.createElement("p");a.className="font-semibold text-base-content",a.textContent=ie(i),s.appendChild(a);let l=ct(o),u=document.createElement("p");u.className="text-xs text-base-content/70",u.textContent=l?`Due ${l}`:"Due today",s.appendChild(u),X.appendChild(s)})}function mt(t=[]){if(!Z)return;let e=(Array.isArray(t)?t:[]).filter(n=>n&&!n.done).sort((n,i)=>{let o=tt(n)-tt(i);if(o!==0)return o;let s=nt(n)-nt(i);return s!==0?s:ie(n).localeCompare(ie(i),void 0,{sensitivity:"base"})}).slice(0,3);if(!e.length){Z.innerHTML='<li class="text-sm text-base-content/60">No focus items.</li>';return}Z.innerHTML="",e.forEach(n=>{let i=document.createElement("li");i.className="rounded-xl border border-base-200 bg-base-100/80 p-4 shadow-sm";let o=document.createElement("div");o.className="flex items-center justify-between gap-3";let s=document.createElement("p");s.className="font-semibold text-base-content",s.textContent=ie(n),o.appendChild(s);let a=Pt(n),l=document.createElement("span");l.className=a.badgeClass,l.textContent=a.badgeLabel,o.appendChild(l),i.appendChild(o);let u=xe(n),m=document.createElement("p");if(m.className="text-xs text-base-content/70",u){let y=ct(u),f=qt(u),b=[];y&&b.push(`Due ${y}`),f&&b.push(f),m.textContent=b.length?b.join(" \u2022 "):"Due soon"}else m.textContent="No due date";i.appendChild(m),Z.appendChild(i)})}var Ut=t=>{if(!Je)return;let e=Array.isArray(t)?t.length:0;Je.textContent=String(e)},Vt=t=>{let e=Array.isArray(t?.detail?.items)?t.detail.items:[];Ut(e),ut(e),mt(e)};document.addEventListener("memoryCue:remindersUpdated",Vt);ut();mt();var we=Ue(Pe),$t={apiKey:"AIzaSyAmAMiz0zG3dAhZJhOy1DYj8fKVDObL36c",authDomain:"memory-cue-app.firebaseapp.com",projectId:"memory-cue-app",storageBucket:"memory-cue-app.firebasestorage.app",messagingSenderId:"751284466633",appId:"1:751284466633:web:3b10742970bef1a5d5ee18",measurementId:"G-R0V4M7VCE6"},ee=null,jt=3,it=120;function Kt(t){if(t==null)return"";let e=String(t).replace(/\s+/g," ").trim();return e?e.length<=it?e:`${e.slice(0,it-1)}\u2026`:""}function zt(t){return!t||typeof t!="object"?!1:[t.pinned,t.isPinned,t.pin].some(n=>{if(typeof n=="boolean")return n;if(typeof n=="string"){let i=n.trim().toLowerCase();return i==="true"||i==="1"||i==="yes"}return!1})}function ot(t){if(!$)return;let e=Array.isArray(t)?t:[];if(!e.length){$.innerHTML='<li class="text-sm text-base-content/60">No pinned notes yet.</li>';return}let n=e.filter(s=>zt(s)),o=(n.length?n:e).slice(0,jt).map(s=>{let a=S(O(s,"title")||"Untitled Cue"),l=O(s,"details"),u=S(Kt(l)),m=u?`<p class="mt-1 text-sm text-base-content/70">${u}</p>`:"";return`
        <li class="rounded-xl border border-base-300 bg-base-100/80 p-3">
          <p class="font-medium text-base-content">${a}</p>
          ${m}
        </li>
      `}).join("");$.innerHTML=o}function Yt(t){if(!w)return;if(!Array.isArray(t)||t.length===0){w.innerHTML='<p class="text-sm text-base-content/60">No cues yet.</p>';return}let e=t.map(n=>{let i=S(O(n,"title")||"Untitled Cue"),o=S(O(n,"details"));return`
        <div class="card w-96 bg-base-100 shadow-xl">
          <div class="card-body">
            <h2 class="card-title">${i}</h2>
            ${o?`<p>${o}</p>`:""}
            <div class="card-actions justify-end">
              <div class="dropdown dropdown-left">
                <label tabindex="0" class="btn btn-ghost btn-xs m-1">...</label>
                <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                  <li><a class="edit-btn" data-id="${S(n.id)}">Edit</a></li>
                  <li><a class="delete-btn" data-id="${S(n.id)}">Delete</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      `}).join("");w.innerHTML=e}async function de(){return ee||(ee=(async()=>{let[{initializeApp:t,getApps:e},{getFirestore:n,enableMultiTabIndexedDbPersistence:i,enableIndexedDbPersistence:o,collection:s,doc:a,getDoc:l,addDoc:u,updateDoc:m,getDocs:y,query:f,orderBy:b,serverTimestamp:ue,setDoc:P,arrayUnion:me}]=await Promise.all([import("https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js"),import("https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js")]),U=e(),fe=U&&U.length?U[0]:t($t),M=n(fe);(function(){let d=typeof window<"u"?window:typeof globalThis<"u"?globalThis:null;d&&(d.__persistenceInitialized__||(d.__persistenceInitialized__=!0,(async()=>{try{await i(M),console.info("[Firestore] Persistence: multi-tab enabled")}catch(E){if(E&&E.code==="failed-precondition")try{await o(M),console.info("[Firestore] Persistence: single-tab fallback enabled")}catch(D){console.warn("[Firestore] Persistence disabled (single-tab fallback failed):",D?.code||D)}else E&&E.code==="unimplemented"?console.warn("[Firestore] Persistence not supported in this browser (online-only)."):console.warn("[Firestore] Persistence initialization error:",E?.code||E)}})()))})();let he=s(M,"cues");return{db:M,cuesCollection:he,getCollection:s,doc:a,getDoc:l,addDoc:u,updateDoc:m,getDocs:y,query:f,orderBy:b,serverTimestamp:ue,setDoc:P,arrayUnion:me}})().catch(t=>{throw console.error("Failed to initialise Firestore for cues",t),t}),ee)}async function Gt(){let t=await de(),{getDocs:e,cuesCollection:n,query:i,orderBy:o}=t,s=i&&o?i(n,o("createdAt","desc")):n;return(await e(s)).docs.map(l=>({id:l.id,...l.data()}))}async function Qt(t){if(!t)return null;let e=await de(),{db:n,doc:i,getDoc:o}=e,s=i(n,"cues",t),a=await o(s);return a.exists()?{id:a.id,...a.data()}:null}async function ft(){if(!(!w&&!$))try{let t=await Gt();Yt(t),ot(t)}catch(t){console.error("Failed to load cues",t),ot([])}}function Wt(t){!N||!C||(Ve(t,we),C.value=t?.id||"",k?.setEditMode(!0),k?.show({mode:"edit"}))}async function Jt(t){let e=t.target instanceof Element?t.target.closest(".edit-btn"):null;if(!e)return;t.preventDefault();let n=e.getAttribute("data-id");if(n)try{let i=await Qt(n);if(!i)return;Wt(i)}catch(i){console.error("Failed to prepare cue for editing",i)}}async function Xt(t){if(t.preventDefault(),!N||!C)return;let e=C.value.trim(),n=je(we);try{let i=await de(),{db:o,doc:s,addDoc:a,updateDoc:l,cuesCollection:u,serverTimestamp:m}=i,y=typeof m=="function"?m():null;if(e){let f=s(o,"cues",e),b={...n};y&&(b.updatedAt=y),await l(f,b)}else{let f={...n};y&&(f.createdAt=y,f.updatedAt=y),await a(u,f)}await ft(),$e(we,C,k?.modalTitle??null,Ot),await k?.hide({reason:"form-submit"})}catch(i){console.error("Failed to save cue",i)}}async function Zt(){!N||!C||!w||(w.addEventListener("click",Jt),N.addEventListener("submit",Xt))}N&&C&&(document.addEventListener("cue:prepare",()=>{C.value="",k?.setEditMode(!1)}),document.addEventListener("cue:close",()=>{C.value="",k?.setEditMode(!1)}));N&&C&&w&&Zt().catch(t=>{console.error("Failed to initialise cue editing",t)});(w||$)&&ft();var r=[],te=null,B=!1,p=t=>{if(!Xe)return;let e=Array.isArray(t)?t:[];Xe.textContent=String(e.length)},ht=t=>{if(!t||typeof t.then!="function"){p(r);return}t.then(e=>{if(Array.isArray(e)){p(e);return}p(r)}).catch(()=>{p(r)})},pt="dailyTasksByDate",ne=null;function Ae(){let t=new Date,e=String(t.getFullYear()),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${i}`}function en(t){if(typeof t!="string")return"";let[e,n,i]=t.split("-"),o=Number.parseInt(e,10),s=Number.parseInt(n,10),a=Number.parseInt(i,10);if(!Number.isFinite(o)||!Number.isFinite(s)||!Number.isFinite(a))return t;let l=new Date(o,s-1,a);return Number.isNaN(l.getTime())?t:new Intl.DateTimeFormat(void 0,{month:"long",day:"numeric",year:"numeric"}).format(l)}function Y(t){if(!Se)return;let e=Array.isArray(t)&&t.some(n=>!!n?.completed);Se.disabled=!e}function F(t){if(!I)return;if(!Array.isArray(t)||t.length===0){I.innerHTML='<p class="text-sm text-base-content/60">No tasks for today yet.</p>',Y([]);return}let e=t.map((n,i)=>{let o=S(n?.text||""),s=!!n?.completed,a=["ml-3","flex-1","text-sm","sm:text-base","text-base-content"];return s&&a.push("line-through","text-opacity-50"),`
        <div class="flex items-center p-3 border-b border-base-200" data-task-index="${i}">
          <input type="checkbox" class="checkbox checkbox-sm" data-task-index="${i}" data-task-text="${o}" ${s?"checked":""} />
          <span class="${a.join(" ")}">${o}</span>
        </div>
      `}).join("");I.innerHTML=e,Y(t)}function ce(){le&&le.classList.remove("hidden")}function tn(){le&&le.classList.add("hidden")}function Ie(t){return{text:typeof t?.text=="string"?t.text:"",completed:!!t?.completed}}function q(t){return Array.isArray(t)?t.map(e=>Ie(e)):[]}function Be(){if(typeof localStorage>"u")return{};try{let t=localStorage.getItem(pt);if(!t)return{};let e=JSON.parse(t);return e&&typeof e=="object"?e:{}}catch(t){return console.warn("Unable to read daily tasks from storage",t),{}}}function yt(t){if(!(typeof localStorage>"u"))try{let e=t&&typeof t=="object"?t:{};localStorage.setItem(pt,JSON.stringify(e))}catch(e){console.warn("Unable to persist daily tasks locally",e)}}function st(t){let e=Be(),n=e&&typeof e=="object"?e[t]:[];return q(n)}function oe(t,e){let n=Be(),i=q(e);return n[t]=i,yt(n),i}function ke(t,e){let n=Be(),i=q(n[t]);return i.push(Ie(e)),n[t]=i,yt(n),i}function Fe(t){let e=typeof t?.code=="string"?t.code.toLowerCase():"";if(e)return e.includes("permission-denied")||e.includes("insufficient-permission");let n=typeof t?.message=="string"?t.message.toLowerCase():"";return!!(n&&n.includes("permission"))}async function Ne(){return ne||(ne=de().then(t=>{let{db:e,getCollection:n}=t,i=typeof n=="function"&&e?n(e,"dailyLists"):null;return{...t,dailyListsCollection:i}}).catch(t=>{throw console.error("Failed to initialise Firestore for daily lists",t),t}),ne)}function Me(t,e){let{doc:n,dailyListsCollection:i,db:o}=t||{};if(typeof n!="function")throw new Error("Firestore document helper is unavailable");return i?n(i,e):n(o,"dailyLists",e)}async function He(){if(!We||!I)return;let t=Ae(),e=en(t);if(We.textContent=e?`Today's List - ${e}`:"Today's List",B){ce();let n=st(t);return r=n,F(n),p(n),Promise.resolve(n)}return te||(I.innerHTML='<p class="text-sm text-base-content/60">Loading tasks\u2026</p>',Y([]),te=(async()=>{try{let n=await Ne(),i=Me(n,t),o=await n.getDoc(i),s=o.exists()?o.data()?.tasks:[];return r=q(s),F(r),oe(t,r),B=!1,tn(),p(r),r}catch(n){if(Fe(n)){console.warn("Falling back to local daily tasks due to permission issue",n),B=!0,ce();let i=st(t);return r=i,F(i),p(i),i}return console.error("Failed to load daily list",n),I.innerHTML='<p class="text-sm text-error">Unable to load daily tasks right now.</p>',r=[],Y(r),p(r),r}})().finally(()=>{te=null})),te}async function nn(t){let e=Ae(),n=Ie(t);if(B){ke(e,n);return}try{let i=await Ne(),o=Me(i,e),s=await i.getDoc(o);if(s.exists()&&typeof i.arrayUnion=="function")await i.updateDoc(o,{tasks:i.arrayUnion(n)});else{let a=s.exists()?s.data()?.tasks:[],l=Array.isArray(a)?q(a):[];l.push(n),typeof i.setDoc=="function"?await i.setDoc(o,{tasks:l},{merge:!0}):await i.updateDoc(o,{tasks:l})}ke(e,n)}catch(i){if(Fe(i)){console.warn("Saving task locally because cloud sync is unavailable",i),B=!0,ce(),ke(e,n);return}throw i}}async function gt(t){let e=Ae(),n=q(t);if(B){oe(e,n);return}try{let i=await Ne(),o=Me(i,e);typeof i.setDoc=="function"?await i.setDoc(o,{tasks:n},{merge:!0}):await i.updateDoc(o,{tasks:n}),oe(e,n)}catch(i){if(Fe(i)){console.warn("Persisting daily tasks locally because cloud sync is unavailable",i),B=!0,ce(),oe(e,n);return}throw i}}function bt(t){[ae,re].forEach(e=>{if(!e)return;let n=e===t;e.classList.toggle("tab-active",n),e.setAttribute("aria-selected",n?"true":"false")})}function on(){!j||!K||(j.classList.remove("hidden"),K.classList.add("hidden"),bt(ae))}function sn(){!j||!K||(j.classList.add("hidden"),K.classList.remove("hidden"),bt(re),ht(He()))}ae&&re&&j&&K&&(ae.addEventListener("click",t=>{t.preventDefault(),on()}),re.addEventListener("click",t=>{t.preventDefault(),sn()}));var h=null,T=!1,se=null;function _(t){if(!v)return;v.setAttribute("aria-pressed",t?"true":"false");let e=v.querySelector('[aria-hidden="true"]');e?e.textContent=t?"\u{1F442}":"\u{1F399}\uFE0F":v.textContent=t?"\u{1F442}":"\u{1F399}\uFE0F"}function an(){T&&(window.clearTimeout(se),se=window.setTimeout(()=>{se=null,T&&Et(!0)},400))}function Et(t=!1){if(!h)return!1;if(T&&!t)return!0;try{return h.start(),T=!0,_(!0),!0}catch{return T=!1,_(!1),!1}}function Re(){if(h){T=!1,window.clearTimeout(se);try{h.stop()}catch{}_(!1)}}function rn(){if(v)try{let t=window.SpeechRecognition||window.webkitSpeechRecognition;if(!t){v.setAttribute("disabled","true"),v.setAttribute("aria-disabled","true"),v.title="Voice input is not supported in this browser.";return}h=new t;let e=document.documentElement?.lang||navigator?.language||"en-AU";if(h.lang=e,h.interimResults=!1,"continuous"in h)try{h.continuous=!0}catch{}h.onresult=n=>{let i=n?.results?.[0]?.[0]?.transcript||"";if(i&&g){g.value=i.trim();try{g.focus({preventScroll:!0})}catch{g.focus()}try{let o=g.value.length;g.setSelectionRange(o,o)}catch{}}},h.onend=()=>{if(!T){_(!1);return}an()},h.onerror=()=>{T=!1,_(!1)}}catch{h=null,_(!1),v.setAttribute("disabled","true"),v.setAttribute("aria-disabled","true")}}rn();v?.addEventListener("click",()=>{h&&(T?Re():Et())});lt?.addEventListener("submit",()=>{T&&Re()});window.addEventListener("pagehide",()=>{T&&Re()});lt?.addEventListener("submit",async t=>{if(t.preventDefault(),!g)return;let e=g.value.trim();if(!e){g.focus();return}let n={text:e,completed:!1};g.value="",g.focus();try{await nn(n);let i=await He();p(i??r)}catch(i){console.error("Failed to add task to the daily list",i),g.value=e,g.focus()}});I?.addEventListener("change",async t=>{let e=t.target instanceof HTMLInputElement?t.target:null;if(!e||e.type!=="checkbox")return;let n=Number.parseInt(e.getAttribute("data-task-index")||"",10);if(!Array.isArray(r)||Number.isNaN(n)||!r[n])return;let i=r.map(s=>({...s})),o=i.map((s,a)=>a===n?{...s,completed:e.checked}:s);r=o,F(o),p(o);try{await gt(o)}catch(s){console.error("Failed to update task completion state",s),r=i,F(i),p(i)}});Se?.addEventListener("click",async()=>{if(!Array.isArray(r)||r.length===0)return;let t=r.filter(n=>!n.completed);if(t.length===r.length)return;let e=r.map(n=>({...n}));r=t,F(t),p(t);try{await gt(t)}catch(n){console.error("Failed to clear completed tasks",n),r=e,F(e),p(e)}});Y(r);p(r);ht(He());var vt="theme",Le="memoryCue:theme-change",De=document.getElementById("theme-menu"),Tt="[data-theme-name],[data-theme-option]",ln=new Set(["dark","dracula","synthwave"]);function L(t){return typeof t=="string"?t.trim():""}function Ct(t){return t instanceof HTMLElement?L(t.getAttribute("data-theme-name")||t.getAttribute("data-theme-option")||""):""}function cn(t){let e=L(t);e&&(document.documentElement.setAttribute("data-theme",e),document.documentElement.classList.toggle("dark",ln.has(e)))}function at(t){let e=L(t);if(e)try{localStorage.setItem(vt,e)}catch(n){console.warn("Unable to save theme preference",n)}}function kt(t){if(!De)return;let e=L(t);De.querySelectorAll(Tt).forEach(i=>{if(!(i instanceof HTMLElement))return;let o=Ct(i),s=e&&o===e;i.setAttribute("aria-checked",s?"true":"false"),i.classList.toggle("active",s)})}function dn(t){let e=L(t);if(!(typeof window>"u"||!e))try{window.dispatchEvent(new CustomEvent(Le,{detail:{theme:e}}))}catch{if(typeof document<"u"&&typeof document.createEvent=="function"){let i=document.createEvent("CustomEvent");i.initCustomEvent(Le,!0,!0,{theme:e}),window.dispatchEvent(i)}}}function St(t,{persist:e=!0,notify:n=!0}={}){let i=L(t);if(!i)return;L(document.documentElement.getAttribute("data-theme"))!==i&&cn(i),e&&at(i),kt(i),n&&dn(i)}function un(){let t="";try{t=localStorage.getItem(vt)||""}catch(n){console.warn("Unable to load theme preference",n)}let e=t||document.documentElement.getAttribute("data-theme")||"";e&&St(e,{persist:!1,notify:!0})}De?.addEventListener("click",t=>{let e=t.target instanceof HTMLElement?t.target.closest(Tt):null;if(!e)return;t.preventDefault();let n=Ct(e);n&&St(n,{persist:!0,notify:!0})});typeof window<"u"&&window.addEventListener(Le,t=>{let e=L(t?.detail?.theme);e&&kt(e)});un()});export default mn();
